$schema: ../../../json_schemas/test_story.schema.yaml

description: Test authinfo endpoint.
chapters:
  - synopsis: Get auth info.
    path: /_plugins/_security/authinfo
    method: GET
    parameters:
      auth_type: basic
      verbose: false
    response:
      status: 200
      payload:
        user_requested_tenant: null
        principal: null
        peer_certificates: '0'
        sso_logout_url: null
        user: 'User [name=admin, backend_roles=[admin], requestedTenant=null]'
        user_name: admin
        backend_roles: [admin]
        custom_attribute_names: []
        roles: [own_index,all_access]
        tenants:
          global_tenant: true
          admin_tenant: true
          admin: true

  - synopsis: Get auth info via POST.
    path: /_plugins/_security/authinfo
    method: POST
    parameters:
      auth_type: basic
      verbose: false
    response:
      status: 200
      payload:
        user_requested_tenant: null
        principal: null
        peer_certificates: '0'
        sso_logout_url: null
        user: 'User [name=admin, backend_roles=[admin], requestedTenant=null]'
        user_name: admin
        backend_roles: [admin]
        custom_attribute_names: []
        roles: [own_index,all_access]
        tenants:
          global_tenant: true
          admin_tenant: true
          admin: true
