$schema: ../../../json_schemas/test_story.schema.yaml

description: Test allowlist endpoints.

chapters:
  - synopsis: Create an allowlist.
    path: /_plugins/_security/api/allowlist
    method: PUT
    request_body:
      payload:
        config:
          enabled: true,
          requests:
            /_cat/nodes: [GET]
    response:
      status: 200
  - synopsis: Get an allowlist.
    path: /_plugins/_security/api/allowlist
    method: GET
    response:
      status: 200
  - synopsis: Patch an allowlist.
    path: /_plugins/_security/api/allowlist
    method: PATCH
    request_body:
      op: remove
      path: /config/requests
      
    response:
      status: 200

