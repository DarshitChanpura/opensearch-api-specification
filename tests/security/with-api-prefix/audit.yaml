$schema: ../../../json_schemas/test_story.schema.yaml

description: Test audit endpoints.

chapters:
  - synopsis: Create an audit config.
    path: /_plugins/_security/api/audit/config
    method: PUT
    request_body:
      payload:
        compliance:
          enabled:
          write_log_diffs:
          read_watched_fields: {}
          read_ignore_users: []
          write_watched_indices: []
          write_ignore_users: []
          read_metadata_only: 
          write_metadata_only: 
          external_config: 
          internal_config: 
        enabled: true
        audit:
          ignore_users:
          ignore_requests: []
          disabled_rest_categories: []
          disabled_transport_categories: []
          log_request_body:
          resolve_indices:
          resolve_bulk_requests:
          exclude_sensitive_headers:
          enable_transport:
          enable_rest:
    response:
      status: 200
  - synopsis: Get an audit config.
    path: /_plugins/_security/api/audit
    method: GET
    response:
      status: 200
  - synopsis: Patch an audit config.
    path: /_plugins/_security/api/audit
    method: PATCH
    request_body:
      payload:
        op:
        path:
        value:
    status: 200

